# APP23
# code to generate all models discussed in the manuscript included. All models were also run through the following checks (M1 = model of interest): 

#Test assumptions
#1. linearity: points should follow center line without obvious pattern going up or down--use graph for #2.
#2. homoskedasticity: points should form "blob" shape rather than triangle (in case of triangle, "consider log transform")
plot(fitted(M1),residuals(M1), ylim=c(-2, 2))^2  
abline(h = 0)

#3. normality of residuals: data should look normal on histogram/fall along line on Q-Q plot.
#If the middle has a shallower slope than the edges on a Q-Q plot, the distribution has fatter tails than normal distribution.
#This is the least important assumption; fairly robust against violation.
hist(residuals(M1))

qqnorm(residuals(M1))
qqline(residuals(M1))

#Get stats for each fixed effect
summary(M1)       #estimates, p-values, AIC, BIC, log likelihoods 
summ(M1)          #R^2
confint(M1)       #confidence intervals for estimates

#Compare to null model (null model = M0, model of interest = M1) 
#Test significance of model
#chi-sq and p-val
anova(M0,M1) 
